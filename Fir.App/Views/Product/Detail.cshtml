@model ProductVM;
<main>
    <section id="secondpageintroduce">
        <div class="container">
            <div class="col-lg-12 info">
                <div class="title">
                    <h1>
                        Product List
                    </h1>
                </div>
                <div class="desc">
                    <p>Where flowers are our inspiration</p>
                </div>
            </div>
        </div>
    </section>

    <section id="orangeamarylls">
        <div class="container">
            <div class="row">
                <div class="images col-lg-6 col-md-12 col-12">
                    <div class="littleImages">
                       
                        @foreach(var item in Model.Product.ProductImages.Where(x => !x.isMain && !x.IsDeleted).ToList())
                        {
                            <div class="littleimage">
                                <img src="~/assets/images/@item.Image"
                                     alt="">
                            </div>
                        }
                    </div>

                    <div class="bigImage">
                        <img src="~/assets/images/@Model.Product.ProductImages.FirstOrDefault(x=>x.isMain).Image"
                             alt="">
                    </div>

                </div>
                <div class="infos col-lg-6 col-md-12 col-12">
                    <div class="info">
                        <div class="title">
                            <h1>@Model.Product.Name</h1>
                        </div>
                        <div class="price">
                            @if (Model.Product.Discount is not null)
                            {
                                <p>$@(Model.Product.Price - (Model.Product.Price * Model.Product.Discount.Percent / 100))</p>
                            }
                            else
                            {
                                <p>$@Model.Product.Price</p>
                            }
                        </div>
                        <div class="desc">
                            <p>
                            @Model.Product.Description
                            </p>
                        </div>
                        <div class="button">
                            <input class="AddBasketInput" type="number" placeholder="Quantity">
                            <div class="counter">
                                <i class="fas fa-chevron-left minus"></i><span class="counting">0</span><i class="fas fa-chevron-right plus"></i>
                            </div>
                            <a class="AddBasketBtn" asp-action="AddBasket" asp-controller="product" asp-route-id="@Model.Product.Id" style="background-color:black;color:white;  padding:12px;" type="button">ADD TO CART <span></span></a>
                        </div>
                        <div class="details">
                            <span>SKU: <a href="">@Model.Product.Id</a></span>
                            <span>Categories: <a href="">
                                    @foreach(var item in Model.Product.ProductCategories)
                                    {
                                        @String.Concat(item.Category.Name," ");
                                    }
                                </a></span>
                            <span>Tags: <a href="">
                                    @foreach (var item in Model.Product.ProductTags)
                                    {
                                        @String.Concat(item.Tag.Name," ");
                                    }
                            </a></span>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </section>

    <section id="tabs">
        <div class="container">


            <div class="row titles">
                <div data-id="powerofflower" class="col-lg-2 col-md-2 col-5 title">
                    <button style="border-top: none !important;" type="button"><span>DESCRIPTION</span></button>
                </div>
                <div data-id="additional" class="col-lg-3 col-md-3 col-8 title">
                    <button style="border-top: none !important;border-left: none !important;border-right: none !important;" type="button"><span>ADDITIONAL INFORMATION</span></button>
                </div>
                <div data-id="reviews" class="col-lg-2 col-md-4 col-5 title">
                    <button style="border-top: none !important;" type="button"><span>REVIEWS (2)</span></button>
                </div>
            </div>


            <div class="row paragraphs">
                <div class="col-lg-12 powerofflower">
                    <div class="title">
                        <h1>@Model.Product.AddTitle</h1>
                    </div>
                    <div class="desc">
                        <p>
                            @Model.Product.AddInfo
                        </p>
                    </div>
                </div>
                <div class="col-lg-12 additional">
                    <span style="font-weight: bolder;">Weight:</span><span style="margin-left: 10px;">@Model.Product.Weight</span><br>
                    <span style="font-weight: bolder;">Dimensions:</span><span style="margin-left: 10px;">
                     @Model.Product.Dimension
                    </span>
                </div>
                <div class="col-lg-12 reviews">
                    <div class="title">
                        <h3>Reviews</h3>
                    </div>
                    <div class="review">
                        <div class="image">
                            <img src="https://fiorello.qodeinteractive.com/wp-content/uploads/2018/04/user-img-1-100x100.png"
                                 alt="">
                        </div>
                        <div class="info">
                            <span>JOSHUA GARCIA</span> <span> 27.04.2018</span>
                            <p>
                                Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget
                                dolor. Aenean massa. Cum sociis Theme natoque penatibus et magnis dis parturient
                                montes, nascetur ridiculus mus.
                            </p>
                        </div>

                    </div>
                    <div class="review">
                        <div class="image">
                            <img src="https://fiorello.qodeinteractive.com/wp-content/uploads/2018/04/user-img-2-100x100.png"
                                 alt="">
                        </div>
                        <div class="info">
                            <span>JOAN STANLEY </span><span>27.04.2018</span>
                            <p>
                                Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget
                                dolor. Aenean massa. Cum sociis Theme natoque penatibus et magnis dis parturient
                                montes, nascetur ridiculus mus.
                            </p>
                        </div>

                    </div>

                    <div class="forum">
                        <div class="title">
                            <h2>Add a review</h2>
                        </div>
                        <div class="warning">
                            <span>
                                Your email address will not be published. Required fields are marked *

                            </span>
                        </div>
                        <form action="" method="post">
                            <label for="yourreiew"><span>Your review *</span></label><br>
                            <input style="height: 200px;" type="text" name="yourreiew" required id=""><br>
                            <label for="name"><span>Name *</span></label><br>
                            <input style="height: 60px;" type="text" name="name" required id=""><br>
                            <label for="name"><span>Email *</span></label><br>
                            <input style="height: 60px;" type="email" name="mail" required id=""><br>
                            <input type="checkbox" name="" id="checkbox"><br>
                            <span>
                                Save my name, email, and website in this browser for the next time I
                                comment.
                            </span><br>
                            <button type="button"><span>SUBMIT</span></button>
                        </form>
                    </div>
                </div>
            </div>

        </div>
    </section>

    <section id="products">
        <div class="container">
            <div class="row">

                <div data-aos="flip-up" data-aos-duration="1000" class="product col-lg-3 col-md-6 popular winter all">
                    <div class="productImage">
                        <img src="https://fiorello.qodeinteractive.com/wp-content/uploads/2018/04/shop-14-img.jpg"
                             alt="">

                    </div>
                    <div class="productTitle">
                        <p>MAJESTY PALM</p>
                    </div>
                    <div class="productPrice">
                        <span class="addToCardBtn" data-id="1">Add to cart</span><span>$</span><span>259</span>
                    </div>
                    <div class="addToCart">
                    </div>
                </div>

                <div data-aos="flip-up" data-aos-duration="1000" class="product col-lg-3 col-md-6 popular winter various all">
                    <div class="productImage">
                        <img src="https://fiorello.qodeinteractive.com/wp-content/uploads/2018/04/shop-13-img.jpg"
                             alt="">
                    </div>
                    <div class="productTitle">
                        <p>FOXGLOW FLOWER</p>
                    </div>
                    <div class="productPrice">
                        <span class="addToCardBtn" data-id="2">Add to cart</span> <span>$</span><span>259</span>
                    </div>
                    <div>
                    </div>
                </div>

                <div data-aos="flip-up" data-aos-duration="1000" class="product col-lg-3 col-md-6 popular winter all">
                    <div class="productImage">
                        <img src=" https://fiorello.qodeinteractive.com/wp-content/uploads/2018/05/shop-10-img.jpg"
                             alt="">
                        <span class="badge badge-dark bg-dark position-absolute"
                              style=" top:3%;left: 8%;transform: scale(1.3);">SOLD</span>
                    </div>
                    <div class="productTitle">
                        <p>SWEET ALYYSUM</p>
                    </div>
                    <div class="productPrice">
                        <span class="addToCardBtn" data-id="3">Add to cart</span> <span>$</span><span>259</span>
                    </div>
                    <div class="addToCart">
                    </div>
                </div>



                <div data-aos="flip-up" data-aos-duration="1000" class="product col-lg-3 col-md-6 popular all">
                    <div class="productImage">
                        <img src="   https://fiorello.qodeinteractive.com/wp-content/uploads/2018/04/shop-11-img.jpg"
                             alt="">
                    </div>
                    <div class="productTitle">
                        <p>SPRING SNOWFLAKE</p>
                    </div>
                    <div class="productPrice">
                        <span class="addToCardBtn" data-id="4">Add to cart</span> <span>$</span><span>170</span>
                    </div>
                    <div>
                    </div>
                </div>

            </div>
        </div>
    </section>
</main>

@section Js{
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
        const AddBasketBtn = document.querySelector(".AddBasketBtn");
        const AddBasketInput = document.querySelector(".AddBasketInput");
        const products = document.querySelectorAll(".add-basket-product ");
        const listProducts = document.querySelector(".listProducts");
        let totalCount = document.querySelector(".totalText");
        let totalPrice = document.querySelector(".priceText span:last-child");
        AddBasketBtn.addEventListener("click", (e) => {
            e.preventDefault();
            let href = AddBasketBtn.getAttribute("href");
            href += `?count=${AddBasketInput.value}`;
            let count = 0;
            let price = 0;
            fetch(href)
                .then(x => x.json())
                .then(x => {
                    if (x.status == 200) {
                        fetch("/product/getall")
                            .then(y => y.json())
                            .then(y => {
                                listProducts.innerHTML = ""
                                y.forEach(basket => {
                                    count++;
                                    price += basket.price * basket.count;
                                    let basketView = `
                                                    <div class="product">
                                                        <div class="image">
                                                            <img src="/assets/images/${basket.image}">
                                                        </div>
                                                        <div>
                                                            <p class="product-name">${basket.name}</p>
                                                            <p>
                                                                <span class="product-count">
                                                                   ${basket.count}
                                                                </span>
                                                                X
                                                                <span class="product-price">
                                                                    ${basket.price}
                                                                </span>
                                                            </p>
                                                        </div>
                                                        <div>
                                                            <div>
                                                                <a href="/product/RemoveBasket/${basket.productId}" class="btn-product-delete" data-id="">x</a>
                                                            </div>
                                                        </div>

                                                    </div>`
                                    listProducts.innerHTML += basketView;
                                    const Toast = Swal.mixin({
                                        toast: true,
                                        position: 'top-end',
                                        showConfirmButton: false,
                                        timer: 1500,
                                        timerProgressBar: true,
                                        didOpen: (toast) => {
                                            toast.addEventListener('mouseenter', Swal.stopTimer)
                                            toast.addEventListener('mouseleave', Swal.resumeTimer)
                                        }
                                    })

                                    Toast.fire({
                                        icon: 'success',
                                        title: 'Added successfully'
                                    })
                                })
                                totalCount.innerHTML = `<span>TOTAL : ${count}</span>`;
                                totalPrice.innerHTML = price;
                            })
                    }
                })
        })
</script>
}